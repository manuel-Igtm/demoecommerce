pipeline {
    agent any
    
    stages {
        stage('Checkout and Explore') {
            steps {
                checkout scm
                sh '''
                    echo "=== Current Directory ==="
                    pwd
                    echo "=== Listing Files ==="
                    ls -la
                    echo "=== Ecommerce Directory ==="
                    ls -la ecommerce/
                    echo "=== Python Info ==="
                    python3 --version
                    which python3
                '''
            }
        }
        
        stage('Test Python Setup') {
            steps {
                sh '''
                    cd ecommerce
                    echo "=== Testing Direct Python ==="
                    python3 -c "import django; print('Django version:', django.get_version())" || echo "Django not installed"
                    
                    echo "=== Installing Requirements ==="
                    pip3 install -r requirements.txt
                    
                    echo "=== Verify Installation ==="
                    python3 -c "import django; print('Django version:', django.get_version())"
                    python3 -c "import rest_framework; print('DRF available')"
                '''
            }
        }
        
        stage('Basic Django Commands') {
            steps {
                sh '''
                    cd ecommerce
                    echo "=== Django Check ==="
                    python3 manage.py check
                    
                    echo "=== Simple Test ==="
                    python3 manage.py test --verbosity=1
                '''
            }
        }
    }
}